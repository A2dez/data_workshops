<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="description" content="CIGI - An Introduction to Bayesian Analysis and Bayesian Regression in R">
    <meta name="author" content="Mick Cooney">
    <meta name="date" content="Friday Nov 17 2017">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <!-- Basic reveal.js theming -->
    <link rel="stylesheet" href="assets/reveal.js/css/reveal.css">

    <!--  Custom theming -->
    <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Raleway:300,400,500,600,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="assets/reveal.js/css/theme/custom_black.css" id="theme">
    <link rel="stylesheet" href="assets/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/custom.css">

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="assets/reveal.js/lib/css/zenburn.css">

    <link rel="stylesheet" href="assets/css/bayesstyle.css">

    <title>An Introduction to Bayesian Analysis and Bayesian Regression in R</title>

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
              tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
          });
    </script>

</head>

<body>

<div class="reveal">

    <div class="slides">

        <section class="center">
            <h2>An Introduction to Bayesian Analysis and Bayesian Regression in R</h2>
            <p><br/></p>
            <p>Mick Cooney</p>
        </section>

        <section>
            <h1 style="text-align: right;">
                <b>Bayesian</b>
            </h1>
            <h1 style="text-align: right;">
                <b>Statistics</b>
            </h1>
            <h1 style="text-align: right;">
                <b>in</b>
            </h1>
            <h1 style="text-align: right;">
                <b><font color="#f08">5</font> Minutes</b>
            </h1>
        </section>

        <section class="center">
            <h2><b>Which is <font color="#fa0">impossible</font></b></h2>
        </section>

        <section class="center">
            <h2><b>So let's rather try to...</b></h2>
        </section>

        <section data-background-color="rgba( 22, 152, 213, 0.6 )">
            <h1 style="text-align: right;">
                <b>Learn About</b>
            </h1>
            <h1 style="text-align: right;">
                <b>Bayes Rule</b>
            </h1>
            <h1 style="text-align: right;">
                <b>in</b>
            </h1>
            <h1 style="text-align: right;">
                <b><font color="#f08">5</font> Minutes</b>
            </h1>
        </section>

        <section class="center">
            <h2><b>So what is <font color="#ff00ff">Bayes Rule?</font></b></h2>
        </section>

        <section class="center" data-background-color="rgba( 22, 152, 213, 0.6 )">
            <h2><b>$$P(A \mid B) = \frac{P(B \mid A) \, P(A)}{P(B)}$$</b></h2>
        </section>

        <section class="center">
            <h2><b>How do we use this?</b></h2>
        </section>

        <section class="center">
            <h2><b>You use <font color="#ff00ff">Bayes Rule</font> all the time</b></h2>
        </section>

        <section class="center">
            <h2><b>You just don't know it</b></h2>
       </section>

        <section class="center">
            <h2><b><font color="#ff00ff">Bayes Rule</font></b></h2>
            <br/>
            <h2 class="fragment"><b>shows how your <font color="#fa0">beliefs</font> change</b></h2>
            <br/>
            <h2 class="fragment"><b>when you get new <font color="#ff0000">information</font></b></h2>
        </section>

        <section class="center">
            <h2><font color="#0af"><b>Let's start with something familiar</b></font></h2>
        </section>

        <section class="center" data-background="assets/img/cointoss.gif">
            <h2><b>Tossing a coin</b></h2>
        </section>

        <section class="center">
            <h2><font color="#0af"><b>Let's toss the coin a few times</b></font></h2>
            <br/>
            <h2 class="fragment"><font color="#0af"><b>After each toss</b></font></h2>
            <br/>
            <h2 class="fragment"><font color="#0af"><b>Tell me if the coin is <font color="#af0">fair</font></b></font></h2>
        </section>

        <section class="center">
            <h2><font color="#0af"><b>At outset it's reasonable to</b></font></h2>
            <br/>
            <h2><font color="#0af"><b>assume the coin is <font color="#af0">fair</font></b></font></h2>
            <br/>
            <h2 class="fragment"><font color="#0af"><b>This is your initial <font color="#fa0">belief</font></b></font></h2>
        </section>

        <section>
            <div style="background-color: rgb(20, 98, 135); width: 100%; height: 400%; position: absolute; top: -100%; left: -45%; z-index:  -1;"></div>
            <div>
                <div style="width: 50%; display: inline-block; margin-right: 5%; vertical-align: top;">
                    <p style="text-align: right;"><b>First toss: H</b></p>
                </div>
                <div style="width: 40%; display: inline-block;">
                    <p style="text-align: left; font-weight: bold;"><span style="color: rgb(204, 153, 204);">Fair? </span><span class="fragment" style="color: rgb(249, 145, 87);">Yes</span></p>
                </div>
            </div>

            <div class="fragment">
                <div style="width: 50%; display: inline-block; margin-right: 5%; vertical-align: top;">
                    <p style="text-align: right;"><b>Second toss: H</b></p>
                </div>
                <div style="width: 40%; display: inline-block;">
                    <p style="text-align: left; font-weight: bold;"><span style="color: rgb(204, 153, 204);">Fair? </span><span  class="fragment" style="color: rgb(249, 145, 87);">Yes</span></p>
                </div>
            </div>

            <div class="fragment">
                <div style="width: 50%; display: inline-block; margin-right: 5%; vertical-align: top;">
                    <p style="text-align: right;"><b>Third toss: H</b></p>
                </div>
                <div style="width: 40%; display: inline-block;">
                    <p style="text-align: left; font-weight: bold;"><span style="color: rgb(204, 153, 204);">Fair? <span  class="fragment" style="color: rgb(249, 145, 87);">Yes</span></span></p>
                </div>
            </div>

            <div class="fragment">
                <div style="width: 50%; display: inline-block; margin-right: 5%; vertical-align: top;">
                    <p style="text-align: right;"><b>Fourth toss: H</b></p>
                </div>
                <div style="width: 40%; display: inline-block;">
                    <p style="text-align: left; font-weight: bold;"><span style="color: rgb(204, 153, 204);">Fair? <span  class="fragment" style="color: rgb(249, 145, 87);">Yes <span class="fragment">doubts set in</span></span></span></p>
                </div>
            </div>

            <div class="fragment">
                <div style="width: 50%; display: inline-block; margin-right: 5%; vertical-align: top;">
                    <p style="text-align: right;"><b>Fifth toss: H</b></p>
                </div>
                <div style="width: 40%; display: inline-block;">
                    <p style="text-align: left; font-weight: bold;"><span style="color: rgb(204, 153, 204);">Fair? <span  class="fragment" style="color: rgb(249, 145, 87);">Possibly</span></span></p>
                </div>
            </div>

            <div class="fragment">
                <div style="width: 50%; display: inline-block; margin-right: 5%; vertical-align: top;">
                    <p style="text-align: right;"><b>Sixth - Tenth toss: H</b></p>
                </div>
                <div style="width: 40%; display: inline-block;">
                    <p style="text-align: left; font-weight: bold;"><span style="color: rgb(204, 153, 204);">Fair? <span style="color: rgb(249, 145, 87);">Probably not</span></span></p>
                </div>
            </div>

            <div class="fragment">
                <div style="width: 50%; display: inline-block; margin-right: 5%; vertical-align: top;">
                    <p style="text-align: right;"><b>Eleventh - Twentieth toss: H</b></p>
                </div>
                <div style="width: 40%; display: inline-block;">
                    <p style="text-align: left; font-weight: bold;"><span style="color: rgb(204, 153, 204);">Fair: <span style="color: rgb(249, 145, 87);">Defintely not</span></span></p>
                </div>
            </div>

            <div class="fragment">
                <div style="width: 50%; display: inline-block; margin-right: 5%; vertical-align: top;">
                    <p style="text-align: right;"><b>Chances of this are: </b></p>
                </div>
                <div style="width: 40%; display: inline-block;">
                    <p style="text-align: left; font-weight: bold;"><span style="color: rgb(204, 153, 204);">1 in </span><span style="color: rgb(249, 145, 87);">1,048,576</span></p>
                </div>
            </div>
        </section>

        <section class="center">
            <h2><font color="#0af"><b>You have just intuitively applied <font color="#ff00ff">Bayes Rule</font> without realising it</b></font></h2>
        </section>

        <section class="center">
            <h2><b>As you got more <font color="#ff0000">information</font></b></h2>
            <br/>
            <h2><b>you altered your <font color="#fa0">belief</font></b></h2>
            <br/>
            <h2><b>that the coin is <font color="#af0">fair</font ></b></h2>
        </section>

        <section class="center">
            <h2><b>Bayes rule allows you quantify this qualitative process</b></h2>
        </section>

		<section class="center">
            <h2><b>Now Let's look at Bayes rule again</b></h2>
        </section>

		<section class="center" data-background-color="rgba( 22, 152, 213, 0.6 )">
            <h2><b>$$P(A \mid B) = \frac{P(B \mid A) \, P(A)}{P(B)}$$</b></h2>
	    </section>

	    <section class="center" data-background-color="rgba( 22, 152, 213, 0.6 )">
            <h2><b>We can simplify this</b></h2>
        </section>

	    <section class="center" data-background-color="rgba( 22, 152, 213, 0.6 )">
            <h2><b>$$P(A \mid B) \propto P(B \mid A) \, P(A)$$</b></h2>
	    </section>

        <section class="center" data-background-color="rgba( 22, 152, 213, 0.6 )">
            <h2><b>$$P(A)$$</b></h2>
            <br/>
            <h4><b>is the prior distribution</b></h4>
            <h4><b>and represents our initial belief</b></h4>
	    </section>

	    <section class="center" data-background-color="rgba( 22, 152, 213, 0.6 )">
            <h2><b>$$P(B \mid A)$$</b></h2>
            <br/>
            <h4><b>is the likelihood model</b></h4>
            <h4><b>and updates as the data arrives</b></h4>
	    </section>

	    <section class="center" data-background-color="rgba( 22, 152, 213, 0.6 )">
            <h2><b>$$P(A \mid B)$$</b></h2>
            <br/>
            <h4><b>is the posterior distribution</b></h4>
            <h4><b>our updated beliefs for $A$</b></h4>
	    </section>

	    <section class="center">
            <h2><b>A picture is worth a thousand words</b></h2>
        </section>


	    <section class="center" data-background="#F1F1F1">

            <div class="bayes">

                <div>

                <div class="wrapper">

                    <div class="sidebar">

                        <form id="form">

                            <div class="form-group">
                                <h4 class="form-group-title">Distribution Parameters</h4>
                                <fieldset>
                                    <label for="priorAlpha">Alpha</label>
                                    <input id="priorAlpha" value="10" type="number" step="10"  min="0" placeholder=">= 0" />
                                </fieldset>

                                <fieldset>
                                    <label for="priorBeta">Beta</label>
                                    <input id="priorBeta" value="10" type="number" step="10" min="0" placeholder=">= 0" />
                                </fieldset>
                            </div>

                            <div class="form-group" style="display:none">
                                <h4 class="form-group-title">Control Results</h4>
                                <fieldset>
                                    <label for="controlSuccesses">Successes</label>
                                    <input id="controlSuccesses" value="0" type="number" min="0" placeholder=">= 0" />
                                </fieldset>

                                <fieldset>
                                    <label for="controlFailures">Failures</label>
                                    <input id="controlFailures" value="0" type="number" min="0" placeholder=">= 0" />
                                </fieldset>
                            </div>

                            <div class="form-group">
                                <h4 class="form-group-title">Coin Toss Results</h4>
                                <fieldset>
                                    <label for="testSuccesses">Heads</label>
                                    <input id="testSuccesses" value="20" type="number" min="0" placeholder=">= 0" />
                                </fieldset>

                                <fieldset>
                                    <label for="testFailures">Tails</label>
                                    <input id="testFailures" value="0" type="number" min="0" placeholder=">= 0" />
                                </fieldset>
                            </div>

                            <div class="form-buttons">
                                <input type="submit" value="Calculate" />
                            </div>

                        </form>
                    </div>

                    <div class="content">

                        <div class="chart">
                            <h2 class="chart-title">Prior &amp; Posterior Probability Density Functions</h2>
                            <div id="pdfplot"></div>
                        </div>

                    </div>
                </div>
                </div>
            </div>
        </section>

	    <section class="center" data-background-color="rgba( 22, 152, 213, 0.6 )">
            <h2><b>Using simple building blocks</b></h2>
            <br/>
            <h2><b>powerful models can be built</b></h2>
	    </section>

		<section>
			<section class="center">
				<h1>Why Bayesian?</h1>
			</section>

			<section class="center" >
				<h1>Interpretability</h1>
				<p><br/>Natural interpretation of output</p>
				<p><br/>
				Credibility region vs Confidence interval</p>
			</section>

			<section class="center">
				<h1>Sparse Data Problems</h1>
				<p><br/>Risk pricing</p>
				<p><br/>Muti-touch attribution</p>
				<p><br/>Account segmentation</p>
			</section>

		</section>

		<section>
			<section class="center">
				<h1>The Bayesian Approach</h1>
			</section>

			<section class="center">
                <h2>Posterior Distribution</h2>
				<p><span class="math display">\[p(\theta \, | D) = \frac{\int p(D \, | \, \theta) \, p(\theta)}{\int p(D)}\]</span></p>
				<br/>
				<span class="math display">\[\begin{eqnarray*}p(\theta) &amp;=&amp; \text{prior distribution of } \theta \\
				p(\theta \, | D) &amp;=&amp; \text{posterior distribution of } \theta \text{ given } D\end{eqnarray*}\]</span>
			</section>

			<section class="center">
				<p><span class="math display">\[p(\theta \, | D) \propto \int p(D \, | \, \theta) \, p(\theta)\]</span></p>
			</section>

			<section class="center">
				<p>How do we calculate this integral?</p>
			</section>

			<section class="center" data-background="assets/img/stan_logo.png" data-state="extradim">
				<h1>Stan</h1>
				<p><br/>MCMC via HMC</p>
				<p><br/>Probabilistic Programming Language</p>
				<p><br/>C++ backend</p>
				<p><br/>Excellent online community</p>
			</section>

			<section class="center">
				<p>Why bother?</p>
			</section>

			<section class="center">
				<p>Captures uncertainty</p>
				<p><br/>Easy to iterate and improve</p>
				<p><br/>Allows generative modelling</p>
				<p><br/>Hierarchical modelling for sparse data</p>
			</section>

			<section class="center">
				<h1>Pitfalls</h1>
				<p><br/>Learning ‘cliff’</p>
				<p><br/>Requires aspects of physics, computation, statistics</p>
				<p><br/>Can seem overwhelming</p>
			</section>

			<section class="center">
				<p>Start with simple linear model</p>
			</section>

		</section>

		<section>
			<section class="center">
				<h1>Linear Models</h1>
			</section>

			<section class="center">
				<h1>Getting Started</h1>
				<p><br/>Ordinary Least Squares (OLS)</p>
				<p><br/>Input variables <span class="math inline">\(X\)</span>, parameters <span class="math inline">\(\beta\)</span></p><br/>
				<span class="math display">\[\begin{eqnarray*}y &amp;=&amp; \beta X + \epsilon, \\\epsilon &amp;\sim&amp; \mathcal{N}(0, \sigma)\end{eqnarray*}\]</span><p><br/>
				Constant variance <span class="math inline">\(\sigma\)</span></p>
			</section>

			<section class="center">
				<p>Rethink linear models in Bayesian language</p>
				<p><br/>Need probability model</p>
			</section>

			<section class="center">
				<h2>Basic Assumptions</h2>
				<p><br/>Data distributed as Normal</p>
				<p><br/>Mean for each point is linear function of <span class="math inline">\(X\)</span>, <span class="math inline">\(\beta X\)</span></p><p><br/>
				<span class="math display">\[y \sim \mathcal{N}(\beta X, \sigma)\]</span></p>
			</section>

			<section class="center">
				<h2>Simple Claims Model</h2>
				<br/>
<pre><code>log_loss lawyer gender seatbelt age
1   3.553632    yes   male      yes  50
2   2.388029     no female      yes  28
3  -1.108663     no   male      yes   5
4   2.401253    yes   male       no  32
5  -1.980502     no   male      yes  30
6  -1.174414    yes female      yes  35
7   1.263562    yes   male      yes  19
</code></pre><p><br/>
				<span class="math display">\[\text{log_loss} \sim \text{lawyer} + \text{seatbelt} + \text{gender} + \text{age}\]</span></p>
				<p><br/>‘Formula notation’</p>
			</section>

			<section class="center">
				<h2>MLE Model (in R)</h2>
				<br/>
				<div class="sourceCode"><pre class="sourceCode r">model_lm &lt;- lm(log_loss ~ lawyer + seatbelt + gender + age
              ,data = modeldata_tbl)</pre>
                </div>
			</section>

			<section>
				<img src="assets/img/regression_ouput.png" />
			</section>

			<section class="center">
				<h2>Bayesian Regression</h2>
				<p><br/>Set up model in Stan</p>
				<p><br/>Effort involved</p>
			</section>

			<section class="center">
				<h2>rstanarm Package</h2>
				<p><br/>Pre-built models</p>
				<p><br/>Linear models, GLMs, ANOVA, etc.</p>
				<p><br/>Built for ease of use</p>
			</section>

			<section class="center">
				<h2><code>rstanarm</code> Version</h2>
				<p><br/></p>
				<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_stanlm &lt;- stan_lm(log_loss ~ lawyer + seatbelt + gender + age
                       ,prior  = R2(location = 0.8)
                       ,data   = modeldata_tbl)</code></pre></div>
			</section>

			<section class="center">
				<p><img src="assets/img/traceplots.png" /></p>
			</section>

			<section class="center">
				<p><img src="assets/img/posterior.png" /></p>
			</section>

			<section class="center">
				<p><img src="assets/img/predictive.png" /></p>
			</section>

		</section>

		<section class="titleslide slide level1">
			<h1>Summary</h1>
				<p><br/>Bayesian output captures uncertainty</p>
				<p><br/>More and more common</p>
				<p><br/>Learning curve</p>
		</section>

		<section class="center">
			<h2>Further Reading</h2>
			<p>Stan Documentation/Vignettes/Case Studies, <em>Stan Core Team et al.</em>
			<br/>
			<a href="http://www.mc-stan.org" class="uri">http://www.mc-stan.org</a></p>
			<p>Data Analysis Using Regression and Multilevel/Hierarchical Models, <em>Gelman and Hill</em>
			<br/><a href="http://www.stat.columbia.edu/~gelman/arm/" class="uri">http://www.stat.columbia.edu/~gelman/arm/</a></p>
			<p>Statistical Rethinking, <em>McElreath</em>
			<br /><a href="http://xcelab.net/rm/statistical-rethinking/" class="uri">http://xcelab.net/rm/statistical-rethinking/</a></p>
			<p>Doing Bayesian Data Analysis, <em>Kruschke</em>
			<br/><a href="https://sites.google.com/site/doingbayesiandataanalysis/" class="uri">https://sites.google.com/site/doingbayesiandataanalysis/</a></p>
		</section>

        <section>
            <h2><b>Questions?</b></h2>
			<p><br/><a href="mailto:mickcooney@gmail.com">mickcooney@gmail.com</a></p>
		    <br>
            <h2><b>Thanks For Listening</b></h2>
            <p><a href="https://www.github.com/kaybenleroll/dublin_r_workshops/">https://www.github.com/kaybenleroll/dublin_r_workshops</a></p>
        </section>

    </div>

</div>

<script src="assets/reveal.js/lib/js/head.min.js"></script>
<script src="assets/reveal.js/js/reveal.js"></script>
<script src="assets/js/bayes.min.js"></script>
<script>

Reveal.initialize({
    center: false,
    previewLinks: true,
    history: true,

    // Optional reveal.js plugins
    dependencies: [
        {
            src: 'assets/reveal.js/lib/js/classList.js',
            condition: function () {
                return !document.body.classList;
            }
        },
        {
            src: 'assets/reveal.js/plugin/markdown/marked.js',
            condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
        },
        {
            src: 'assets/reveal.js/plugin/markdown/markdown.js',
            condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
        },
        {
            src: 'assets/reveal.js/plugin/highlight/highlight.js',
            async: true,
            callback: function () {
                hljs.initHighlightingOnLoad();
            }
        },
        {
            src: 'assets/reveal.js/plugin/zoom-js/zoom.js',
            async: true
        },
        {
            src: 'assets/reveal.js/plugin/notes/notes.js',
            async: true
        },
        {
            src: 'assets/reveal.js/plugin/math/math.js',
            async: true
        }
	]
});
</script>
</body>
</html>
