<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><title>Assignment 10</title><link rel="stylesheet" type="text/css" href="css/green.css" title="green" /> <link rel="stylesheet" type="text/css" href="css/calendar.css" title="calendar" /> <link rel="alternate stylesheet" type="text/css" media="all" href="css/purple.css" title="purple" /> <link rel="alternate stylesheet" type="text/css" media="all" href="css/large.css" title="large" /> <link rel="alternate stylesheet" type="text/css" media="all" href="css/reverse.css" title="reverse" /> <!-- the @import method only works from 5.0 and upwards  --><!-- so, using @import would "hide" the more sophisticated sheet from < 5.0 browsers --><!-- <style type="text/css" media="all">@import "fancy_style.css";</style> --><script language="JavaScript" type="text/javascript" src="js/styleswitcher.js"></script> <style type="text/css"><!--.style12 {	color: #008000;	font-weight: bold;}.style29 {color: #CC0000; font-weight: bold; }.style34 {color: #993333; font-weight: bold; font-size: larger; }.style37 {font-weight: bold; color: #660099;}.style38 {	color: #666666;	font-weight: bold;}--></style></head><body><h1 align="center"> <a name="assign10" id="assign10"></a>Assignment 10 </h1><h3 class="style34">Due Date </h3><p>Friday, April 20, 2007</p><p><span class="style34">Data</span></p><p>The file <a href="../../assignments/assign10/radon.txt">radon.txt</a> contains level-1 data and <a href="../../assignments/assign10/cty.txt">cty.txt</a> contains level-2 data for this problem.</p><p><span class="style34">The Problem</span></p><p>In this exercise we carry out some of the analyses described in Price <em>et al. </em>(1996), Lin <em>et al.</em> (1999), and Gelman and Hill (2006). Their object was to develop a model to predict indoor radon concentration for houses in the state of Minnesota. The authors argue that indoor radon measurements are lognormally distributed so we'll be working with log-transformed radon measurements coupled with a normal error distribution. </p><p>The authors carried out a 2-level hierarchical analysis using the county in which a  home is located to define the data structure. In truth these data are only weakly structured. The data were obtained as a simple random sample (actually a stratified random sample but the stratification is not related to the grouping variable), not a cluster sample, and so the presumed structure is not a result of sampling. Furthermore we don't have repeated measurements of the same observational unit. Instead the concern is that radon observations taken from the same county are likely to be correlated due to their spatial proximity and possession of a similar geology. The authors measured variables at both the county and individual home level and used a multilevel model to account for differential variation at each level. </p><p><span class="style34">Question 1 </span></p><ol>  <li> Read in the data from the file <a href="../../assignments/assign10/radon.txt">radon.txt</a>. Subset the data set so that you are only working with  observations from the state of Minnesota. Use the variable <span class="style38">state</span> (not <span class="style38">state2</span>) to select these observations. The variable  <span class="style38">state</span> assigns homes from Indian reservations to a special category and thus they will not be part of our analysis.</li>  <li> The variable <span class="style38">activity</span> records home radon levels in picoCuries per liter. There are a few cases where a value of zero was reported for <span class="style38">activity</span>. The actual radon levels are probably not truly zero but are just too small to be detected by  the instrument used. Such measurements are called left-censored. While there are formal ways of dealing with censored data, for this analysis replace the zero values with 0.05&mdash;a value halfway between 0 and the smallest reported nonzero measurement, 0.10. Having made this change then log-transform the radon values.</li>  <li>The variable <span class="style38">floor</span> records the lowest living area in the home at which radon measurements were made--0 for basement and 1 for first floor. Generate a lattice graph that plots log radon levels against floor level separately for each county in Minnesota. Each panel should show both a scatter plot of the data and a line segment that connects the mean log radon levels for homes with basements to the mean log radon levels of homes without basements.</li></ol><p><span class="style12">Hints</span>: </p><ol>  <li>Convert the <span class="style38">floor</span> variable to a factor and plot log radon levels against this factor. This will set the tick marks on the <em>x</em>-axis so that only the two levels of the factor are displayed. </li>  <li>The county names are too long to display completely in the panel strips even when their size is reduced. If we use the first six letters of each county name we can uniquely identify each county. Use the <span class="style29">substr</span> function in R to pull off the first six letters of each county name (contained in the variable <span class="style38">county</span>) to create a county abbreviation variable. Use this county abbreviation variable as your grouping variable in the lattice graph.</li>  <li>There are a total of 85 counties in the data set after removing the Indian reservations so a sensible display is to arrange the panels in 17 columns and 5 rows. This can be accomplished with the <span class="style37">layout</span> argument of the <span class="style29">xyplot</span> function by specifying <span class="style37">layout=c(17,5)</span>.</li>  <li> Not all counties have sample observations for both values of the variable <span class="style38">floor</span>. This prevents us from using the <span class="style29">panel.abline</span> function and <span class="style29">lm</span> to generate a regression line as was done in class. Instead proceed as follows. Within the panel function use <span class="style29">tapply</span> to obtain the mean of the <em>y</em>-variable for different levels of the <em>x</em>-variable. The means will be given the names 0 and 1 by <span class="style29">tapply</span> (or just one of these value when both levels of <span class="style38">floor</span> are not present in the sample from that  county). In each panel  the displayed locations of the tick marks on the <em>x</em>-axis are at <em>x</em> = 1 and  <em>x</em> = 2. Use the <span class="style29">panel.lines</span> function to draw the line segments. For its <em>x</em>-argument extract the names from the <span class="style29">tapply</span> object using the <span class="style29">names</span> function,  convert the result to numeric values using the <span class="style29">as.numeric</span> function, and add 1 to the result to yield values of 1 and 2 instead of 0 and 1. For the <em>y</em>-argument of <span class="style29">panel.lines </span>use the means calculated by <span class="style29">tapply</span>. </li></ol><p><span class="style34">Question 2 </span></p><blockquote>  <p> Fit an unconditional means multilevel model to these data using log radon level as the response and the data structured by county. Obtain and identify the variance components and calculate the intraclass correlation coefficient. Is the evidence very strong that these data are structured?</p></blockquote><p><span class="style34">Question 3 </span></p><ol>  <li> Add <span class="style38">floor</span> as a level-1 predictor to the unconditional means model and fit a random intercepts model. Provide two separate pieces of evidence that the variable <span class="style38">floor</span> should be retained in the model.</li>  <li> Offer a statistical argument (not a philosophical one) why intercepts should be treated as random across counties rather than fixed for these data. (Hint: compare the random intercept model to a complete pooling model using an appropriate statistic.)</li>  <li>Calculate an R<sup>2</sup> that is appropriate for the random intercepts model. </li></ol><p><span class="style34">Question 4 </span></p><blockquote>  <p> Extend the model of Question 3 to the random slopes and intercepts model. Offer statistical evidence to show that   random &quot;slopes&quot; are not necessary in this model.</p></blockquote><p><span class="style34">Question 5 </span></p><ol>  <li> Read  the second data set <a href="../../assignments/assign10/cty.txt">cty.txt</a> of county data into R. Subset it so that you are only working with the data  for Minnesota counties. (Use the variable <span class="style38">st</span> to subset the data.) </li>  <li>Merge the county-level Minnesota data to the household-level Minnesota data set created in Question 1. The key fields that link up the two data sets are <span class="style38">cntyfips</span> in the household data set and <span class="style38">ctfips</span> in the county data set. (Note: There are two counties in the county data set that do not appear in the household data  set.)</li>  <li>Add log(<span class="style38">Uppm</span>), a measurement of soil uranium levels  at the county level, to the model from Question 3, the random intercepts model. Argue that this group-level variable should be retained in the model.</li>  <li>Calculate an R<sup>2</sup> that is appropriate for quantifying the importance of log(<span class="style38">Uppm</span>) as a predictor. </li></ol><p class="style34">Cited References</p><p>Gelman, A. and J. Hill. 2006. <em>Data Analysis Using Regression and Multilevel/Hierarchical Models</em>. Cambridge University Press: New York.<br>Lin, C., A. Gelman, P. N. Price, and D. H. Krantz. 1999. Analysis of local decisions using hierarchical modeling, applied to home radon measurement and remediation. <em>Statistical Science</em> <strong>14</strong>(3): 305&ndash;337.<br>Price, P. N., A. V. Nero, and A. Gelman 1996. Bayesian prediction of mean indoor radon concentrations in Minnesota counties. <em>Health Physics </em> <strong>71</strong>(6): 922&ndash;936.</p><p align="center"><a href="../../index.html">Course Home Page</a> </p><hr align="center" width="75%"><!--Standard footer follows --><p></p><table width="586" border="3" cellspacing="2" cellpadding="2" align="CENTER">  <tr bgcolor="#CCCCCC">    <td width="100%"><font size=-1>Jack Weiss<br>          <i>Phone: </i>(919) 962-5930<br>          <i>E-Mail:</i> jack_weiss@unc.edu<br>          <i>Address: </i>Curriculum in Ecology, Box 3275, University of North Carolina, Chapel Hill, 27516<br>      Copyright &copy; 2007<br>      Last Revised--April 16, 2007<br>      URL: <a href="#assign10" target="_self">http://www.unc.edu/courses/2007spring/enst/562/001/docs/assignments/assign10.htm</a></font></td>  </tr></table><p align="center">&nbsp;</p></body></html>