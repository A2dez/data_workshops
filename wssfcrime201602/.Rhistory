lsos()
 source("create_sim_incident_data.R")
lsos()
incident_dt
dbconnection <- dbConnect(dbDriver("PostgreSQL"), host = 'localhost', dbname = 'sfcrime', user = 'geospuser', pass = 'geospuser')

dbGetInfo(dbconnection)
dbGetInfo(dbDriver("PostgreSQL"))
lsos()
train_dt <- dbGetQuery(dbconnection, "SELECT * FROM incident_data i, category_data c WHERE i.id = c.id ORDER BY incident_ts")
setDT(train_dt)

train_dt <- dbGetQuery(dbconnection, "SELECT id FROM incident_data i WHERE i.label = 'train' ORDER BY incident_ts")
setDT(train_dt)
train_dt <- dbGetQuery(dbconnection, "SELECT id, incident_ts, label FROM incident_data i WHERE i.label = 'train' ORDER BY incident_ts")
setDT(train_dt)

train_dt
train_dt[runif(.N) < 0.2]
train_dt[runif(.N) < 0.1]
lsos()
test_dt
train_dt <- dbGetQuery(dbconnection, "SELECT id, incident_ts, label FROM incident_data i WHERE i.label = 'train' ORDER BY incident_ts")
setDT(train_dt)

test_dt <- train_dt[runif(.N) < 0.2]

test_dt
test_dt <- train_dt[runif(.N) < 0.1]
test_dt
?subset
?subset
?setdiff
setdiff(c(1,3,7), 1:10]
setdiff(c(1,3,7), 1:10)
setdiff(1:10, c(1,3,7), )
setdiff(1:10, c(1,3,7))
subset_dt <- train_dt[runif(.N) < 0.2]

train_id <- subset_dt[runif(.N) < 0.5]
check_id <- setdiff(subset_dt$id, trainid);

subset_dt <- train_dt[runif(.N) < 0.2]

train_id <- subset_dt[runif(.N) < 0.5]
check_id <- setdiff(subset_dt$id, train_id);

source("setup_data.R")
source("setup_data.R")
lsos()
rm(list = ls())
lsos()
dbGetInfo(dbDriver("PostgreSQL"))
dbDisconnect(dbGetInfo(dbDriver("PostgreSQL"))$connectionIds[[1]])
dbDisconnect(dbGetInfo(dbDriver("PostgreSQL"))$connectionIds[[1]])
dbGetInfo(dbDriver("PostgreSQL"))
source("setup_data.R")
incident_data_dt
lsos()
dbWriteTable(dbconnection, name = 'incident_data', value = incident_dt, append = TRUE, row.names = FALSE)

dbDisconnect(dbGetInfo(dbDriver("PostgreSQL"))$connectionIds[[1]])
dbDisconnect(dbGetInfo(dbDriver("PostgreSQL"))$connectionIds[[1]])
lsos()
rm(list = ls())
gc()
lsos()
gc()
lsos()
source("setup_data.R")
dbDisconnect(dbGetInfo(dbDriver("PostgreSQL"))$connectionIds[[1]])
lsos()
dbWriteTable(dbconnection, name = 'incident_data', value = incident_dt, append = TRUE, row.names = FALSE)
dbWriteTable(dbconnection, name = 'category_data', value = category_dt, append = TRUE, row.names = FALSE)

dbconnection <- dbConnect(dbDriver("PostgreSQL"), host = 'localhost', dbname = 'sfcrime', user = 'geospuser', pass = 'geospuser')

dbWriteTable(dbconnection, name = 'incident_data', value = incident_dt, append = TRUE, row.names = FALSE)
dbWriteTable(dbconnection, name = 'category_data', value = category_dt, append = TRUE, row.names = FALSE)

lsos()
rm(train_dt, test_dt, incident_test_dt)
lsos()
dbDisconnect(dbGetInfo(dbDriver("PostgreSQL"))$connectionIds[[1]])
dbDisconnect(dbGetInfo(dbDriver("PostgreSQL"))$connectionIds[[1]])
rm(list = ls())
lsos()
gc()
dbDisconnect(dbGetInfo(dbDriver("PostgreSQL"))$connectionIds[[1]])
lsos()
dbDisconnect(dbGetInfo(dbDriver("PostgreSQL"))$connectionIds[[1]])
source("setup_data.R")
lsos()
q()
y
