library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
q()
y
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
x <- runif(30, 0, 20)
y <- 2.4 * x + 3 + rnorm(0, 2)

qplot(x, y, geom = 'line')

x <- runif(30, 0, 20)
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
rm(list = ls())
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
qplot(x1, y1, geom = 'point') + geom_line(aes(x = x1, y = y1), colour = 'red')

x1
y1
qplot(x1, y1, geom = 'point') + geom_line(aes(x = x1, y = y1), colour = 'red')
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
qplot(x1, y1, geom = 'point') + geom_line(aes(x = x1, y = y1), colour = 'red')

library(knitr); knit2pdf("talkdvggplot201603.Rnw")
lsos()
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
load("longtermvol.dt.rda")
lsos()
longtermvol.dt
qplot(date, histvol, data = longtermvol.dt[horizon == 250], geom = 'line', colour = symbol)
qplot(date, histvol, data = longtermvol.dt[horizon == 250], geom = 'line', colour = symbol) + geom_dl(aes(label = symbol), last.bumpup)
library(directlabels)
qplot(date, histvol, data = longtermvol.dt[horizon == 250], geom = 'line', colour = symbol) + geom_dl(aes(label = symbol), last.bumpup)
qplot(date, histvol, data = longtermvol.dt[horizon == 250], geom = 'line', colour = symbol) + geom_dl(aes(label = symbol), list(last.bumpup))
qplot(date, histvol, data = longtermvol.dt[horizon == 250], geom = 'line', colour = symbol) + geom_dl(aes(label = symbol, last.bumpup))
?geom_dl
qplot(date, histvol, data = longtermvol.dt[horizon == 250], geom = 'line', colour = symbol) + geom_dl(aes(label = symbol), method = last.bumpup)
qplot(date, histvol, data = longtermvol.dt[horizon == 250], geom = 'line', colour = symbol) + geom_dl(aes(label = symbol), list('last.bumpup')) +
qplot(date, histvol, data = longtermvol.dt[horizon == 250], geom = 'line', colour = symbol) + geom_dl(aes(label = symbol), list('last.bumpup'))
qplot(date, histvol, data = longtermvol.dt[horizon == 250], geom = 'line', colour = symbol) + geom_dl(aes(label = symbol), method = list('last.bumpup'))
qplot(date, histvol, data = longtermvol.dt[horizon == 250], geom = 'line', colour = symbol) + geom_dl(aes(label = symbol), method = list('last.bumpup')) + theme(legend.position = 'none')
qplot(date, histvol, data = longtermvol.dt[horizon == 250], geom = 'line', colour = symbol) + geom_dl(aes(label = symbol), method = list('last.bumpup', hjust = 1)) + theme(legend.position = 'none')
qplot(date, histvol, data = longtermvol.dt[horizon == 2500], geom = 'line', colour = symbol) + geom_dl(aes(label = symbol), method = list('last.bumpup', hjust = 1)) + theme(legend.position = 'none')
qplot(date, histvol, data = longtermvol.dt[horizon == 1250], geom = 'line', colour = symbol) + geom_dl(aes(label = symbol), method = list('last.bumpup', hjust = 1)) + theme(legend.position = 'none')
qplot(date, histvol, data = longtermvol.dt[horizon == 1250], geom = 'line', colour = symbol) + geom_dl(aes(label = symbol), method = list('last.bumpup', hjust = 0.5)) + theme(legend.position = 'none')
qplot(date, histvol, data = longtermvol.dt[horizon == 1250], geom = 'line', colour = symbol) + geom_dl(aes(label = symbol), method = list('last.bumpup', hjust = 0.1)) + theme(legend.position = 'none')
qplot(date, histvol, data = longtermvol.dt[horizon == 1250], geom = 'line', colour = symbol) + geom_dl(aes(label = symbol), method = list('last.bumpup', hjust = 0.3)) + theme(legend.position = 'none')
qplot(date, histvol, data = longtermvol.dt[horizon == 1250], geom = 'line', colour = symbol) + geom_dl(aes(label = symbol), method = list('last.bumpup', hjust = 0.5)) + theme(legend.position = 'none')
mpg
head(mpg)
str(mpg)
??tbl_df
mpg
str(mpg)
head(mpg)
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
lsos()
saveRDS(longtermvol.dt, file = 'longtermvol.dt.rds', compress = 'xz')
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
ggplot(aes(x = x, y = dens), data = plot_dt)
    + geom_line(colour = label)

ggplot(aes(x = x, y = dens), data = plot_dt) + geom_line
ggplot(aes(x = x, y = dens, colour = label), data = plot_dt) + geom_line
ggplot(aes(x = x, y = dens, colour = label), data = plot_dt) + geom_line()
ggplot(aes(x = x, y = dens, colour = label), data = plot_dt) + geom_line()
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
lsos()
saveRDS(longtermvol.dt, file = 'data/longtermvol.dt.rds', compress = 'xz')
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
readRDS
readRDS("data/longtermvol.dt.rds")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
longtermvol.dt
rm(longtermvol.dt)
lsos()
longterm_dt
ggplot(aes(x = date, y = histvol, colour = symbol), data = longterm_dt) + facet_wrap(~horizon)
ggplot(aes(x = date, y = histvol, colour = symbol), data = longterm_dt) + facet_wrap(~horizon) + geom_line()
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
load("~/Dropbox/Temp/test.lst.rda")
qplot(Var2, value, data = melt(veganeutral.port.weights.lst$weights.bootstrapped$t), geom = 'boxplot', xlab = 'Symbol', ylab = 'Portfolio Weight', main = 'Vega-Neutral Portfolio Weights') + scale_y_continuous(labels = percent, limits = c(-1, 1)) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5)); 
qplot(Var2, value, data = melt(test.lst$weights.bootstrapped$t), geom = 'boxplot', xlab = 'Symbol', ylab = 'Portfolio Weight', main = 'Vega-Neutral Portfolio Weights') + scale_y_continuous(labels = percent, limits = c(-1, 1)) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5)); 
test.lst$weights.bootstrapped$t
veganeutral_weights_matrix <- test.lst$weights.bootstrapped$t
rm(test.lst)
qplot(Var2, value, data = melt(veganeutral_weights_matrix), geom = 'boxplot', xlab = 'Symbol', ylab = 'Portfolio Weight', main = 'Vega-Neutral Portfolio Weights') + scale_y_continuous(labels = percent, limits = c(-1, 1)) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5));
veganeutral_weights_matrix[1:10, 1:7]
veganeutral_weights_matrix[veganeutral_weights_matrix < 1e-6] <- 0
veganeutral_weights_matrix[1:10, 1:7]
qplot(Var2, value, data = melt(veganeutral_weights_matrix), geom = 'boxplot', xlab = 'Symbol', ylab = 'Portfolio Weight', main = 'Vega-Neutral Portfolio Weights') + scale_y_continuous(labels = percent, limits = c(-1, 1)) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5));
saveRDS(veganeutral_weights_matrix, file = 'data/veganeutral_weights_matrix.rds', compress = 'xz')
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
lsos()
pv
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
gpdata_dt <- readRDS("data/gpdata_dt.rds")
gpplot_dt <- readRDS("data/gpplot_dt.rds")

gpdata_dt
gpplot_dt
pv <- ggplot() +
    geom_line(aes(x = x, y = value, group = Var1)
             ,data = gpplot_dt, size = 0.3, alpha = 0.2) +
    geom_point(aes(x, y), data = gpdata_dt, colour = 'red') +
    geom_errorbar(aes(x, ymin, ymax)
                 ,data = gpdata_dt, colour = 'red', width = 0.1) +
    xlab(expression(x)) +
    ylab(expression(f(x))) +
    ggtitle("Gaussian Process Regression Allowing for y Uncertainty")

plot(pv)
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
pv <- ggplot(aes(x = date, y = histvol, colour = symbol)
            ,data = longterm_dt) +
    facet_wrap(~horizon) +
    geom_line(size = 0.1) +
    expand_limits(y = 0) +
    xlab("Date") +
    ylab("Unconditional Volatility") +
    ggtitle("Facetted Lineplot of Volatility of DJIA Stocks")

plot(pv)
pv <- ggplot(aes(x = date, y = histvol, colour = symbol)
            ,data = longterm_dt) +
    facet_wrap(~horizon) +
    geom_line(size = 0.3) +

    expand_limits(y = 0) +
    xlab("Date") +
    ylab("Unconditional Volatility") +
    ggtitle("Facetted Lineplot of Volatility of DJIA Stocks")

plot(pv)
?geom_boxplot
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
losscurves_dt
losscurves_dt[1:3]
ggplot(aes(x = DevelopmentLag, y = CumPaidLoss, colour = AccidentYear), data = losscurves_dt) + geom_line()
ggplot(aes(x = DevelopmentLag, y = CumPaidLoss, colour = as.character(AccidentYear)), data = losscurves_dt) + geom_line()
ggplot(aes(x = DevelopmentLag, y = CumPaidLoss / EarnedPremDIR, colour = as.character(AccidentYear)), data = losscurves_dt) + geom_line()
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
pv <- ggplot(aes(x = DevelopmentLag
                ,y = CumPaidLoss / EarnedPremDIR
                ,colour = as.character(AccidentYear))
            ,data = losscurves_dt) +
    geom_line() +
    guides(colour = guide_legend(title = "Year"))

plot(pv)
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
lsos()
gc()
pv <- ggplot(aes(x = DevelopmentLag
lsos()
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
q()
y
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
fundnav_dt <- readRDS("data/fundnav.dt.rds")
fundnav_dt
qplot(date, nav, data = fundnav.dt, colour = fundlabel)
qplot(date, nav, data = fundnav_dt, colour = fundlabel)
qplot(date, nav, data = fundnav_dt, geom = 'line', colour = fundlabel)
qplot(date, nav, data = fundnav_dt, geom = 'line', colour = fundlabel, size = I(0.3))
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
?geom-dl
?geom_dl
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
pv <- ggplot() +
    geom_line(aes(x = date, y = nav, colour = fundlabel)
             ,data = fundnav_dt
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(label = fundlabel)
           ,method = list('last.bumpup'
                         ,hjust = 0.5)) +
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")

plot(pv)
pv <- ggplot(data = fundnav_dt) +
    geom_line(aes(x = date, y = nav, colour = fundlabel)
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(label = fundlabel)
           ,method = list('last.bumpup'
                         ,hjust = 0.5)) +
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")


    geom_line(aes(x = date, y = nav, colour = fundlabel)
             ,data = fundnav_dt
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(label = fundlabel)
           ,method = list('last.bumpup'
                         ,hjust = 0.5)) +
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")

pv <- ggplot(data = fundnav_dt) +
    geom_line(aes(x = date, y = nav, colour = fundlabel)
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(label = fundlabel)
           ,method = list('last.bumpup'
                         ,hjust = 0.5)) +
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")

plot(pv)
pv <- ggplot(data = fundnav_dt) +
    geom_line(aes(x = date, y = nav
                 ,colour = fundlabel)
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(x = date, y = nav
               ,label = fundlabel)
           ,method = list('last.bumpup'
                         ,hjust = 0.5)) +
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")

plot(pv)
pv <- ggplot(data = fundnav_dt) +
    geom_line(aes(x = date, y = nav
                 ,colour = fundlabel)
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(x = date, y = nav
               ,label = fundlabel)
           ,method = list('last.bumpup'
                         ,hjust = -0.5)) +
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")

plot(pv)
pv <- ggplot(data = fundnav_dt) +
    geom_line(aes(x = date, y = nav
                 ,colour = fundlabel)
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(x = date, y = nav
               ,colour = fundlabel
               ,label  = fundlabel)
           ,method = list('last.bumpup'
                         ,hjust = 1)) +
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")

plot(pv)
pv <- ggplot(data = fundnav_dt) +
    geom_line(aes(x = date, y = nav
                 ,colour = fundlabel)
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(x = date, y = nav
               ,label  = fundlabel)
           ,method = list('last.bumpup'
                         ,hjust = 1)) +
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")

plot(pv)
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
pv <- ggplot(data = fundnav_dt) +
    geom_line(aes(x = date, y = nav
                 ,colour = fundlabel)
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(x = date, y = nav
               ,colour = fundlabel
               ,label  = fundlabel)
           ,method = list('last.bumpup')) +
    expand_limits(y = 0)
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")

pv <- ggplot(data = fundnav_dt) +
    geom_line(aes(x = date, y = nav
                 ,colour = fundlabel)
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(x = date, y = nav
               ,colour = fundlabel
               ,label  = fundlabel)
           ,method = list('last.bumpup')) +
    expand_limits(y = 0) +
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")

plot(pv)
?expand_limits
pv <- ggplot(data = fundnav_dt) +
    geom_line(aes(x = date, y = nav
                 ,colour = fundlabel)
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(x = date, y = nav
               ,colour = fundlabel
               ,label  = fundlabel)
           ,method = list('last.bumpup')) +
    expand_limits(x = as.Date('2017-01-01')
                 ,y = 0) +
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")

plot(pv)
pv <- ggplot(data = fundnav_dt) +
    geom_line(aes(x = date, y = nav
                 ,colour = fundlabel)
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(x = date, y = nav
               ,colour = fundlabel
               ,label  = fundlabel)
           ,method = list('last.bumpup')) +
    expand_limits(x = as.Date('2017-07-01')
                 ,y = 0) +
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")

plot(pv)
pv <- ggplot(data = fundnav_dt) +
    geom_line(aes(x = date, y = nav
                 ,colour = fundlabel)
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(x = date, y = nav
               ,label  = fundlabel)
           ,method = list('last.bumpup')) +
                         ,hjust = -1)) +
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")

pv <- ggplot(data = fundnav_dt) +
    geom_line(aes(x = date, y = nav
                 ,colour = fundlabel)
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(x = date, y = nav
               ,label  = fundlabel)
           ,method = list('last.bumpup'
                         ,hjust = -1)) +
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")

plot(pv)
pv <- ggplot(data = fundnav_dt) +
    geom_line(aes(x = date, y = nav
                 ,colour = fundlabel)
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(x = date, y = nav
               ,label  = fundlabel)
           ,method = list('last.bumpup'
                         ,hjust = 1)) +
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")

plot(pv)
pv <- ggplot(data = fundnav_dt[date >= as.Date('2007-01-01') &
                               date <= as.Date('2011-01-01')]) +
    geom_line(aes(x = date, y = nav
                 ,colour = fundlabel)
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(x = date, y = nav
               ,colour = fundlabel
               ,label  = fundlabel)
           ,method = list('last.bumpup')) +
    expand_limits(y = 0) +
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")

plot(pv)
pv <- ggplot(data = fundnav_dt[date >= as.Date('2008-01-01') &
                               date <= as.Date('2010-01-01')]) +
    geom_line(aes(x = date, y = nav
                 ,colour = fundlabel)
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(x = date, y = nav
               ,colour = fundlabel
               ,label  = fundlabel)
           ,method = list('last.bumpup')) +
    expand_limits(x = as.Date('2011-01-01')
                 ,y = 0) +
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")

plot(pv)
pv <- ggplot(data = fundnav_dt[date >= as.Date('2008-01-01') &
                               date <= as.Date('2010-01-01')]) +
    geom_line(aes(x = date, y = nav
                 ,colour = fundlabel)
             ,size = 0.3) +
    scale_y_continuous(labels = dollar) +
    theme(legend.position = 'none') +
    geom_dl(aes(x = date, y = nav
               ,colour = fundlabel
               ,label  = fundlabel)
           ,method = list('last.bumpup')) +
    expand_limits(x = as.Date('2010-07-01')
                 ,y = 0) +
    xlab("Date") +
    ylab("Fund NAV") +
    ggtitle("Fund NAVs for Equity and Equity Option Strategies")

plot(pv)
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
q()
y
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
q()
y
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
q()
y
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
pv <- ggplot(mtcars, aes(x = displ, y = hwy)) +
    geom_point() +
    facet_wrap(~class)

plot(pv)
head(mtcars)
mtcars
mpg
lsos()
pv <- ggplot(mtcars, aes(x = displ, y = hwy)) +
    geom_point()

plot(pv)
?ggplot
head(mtcars)
head(mpg)
?mpg
library(knitr); knit2pdf("talkdvggplot201603.Rnw")
q()
y
library(knitr)
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
ppauto_dt
ppauto_dt[, unique(GRCODE)]
ppauto_dt[GRCODE == 353]
knit2pdf("talkbm201604.Rnw")
ppauto_snapshot_dt <- ppauto_dt[GRCODE == use_grcode
                              ][DevelopmentYear < 1998
                              ][, .(grcode     = GRCODE
                                   ,accyear    = AccidentYear
                                   ,devlag     = DevelopmentLag
                                   ,premium    = EarnedPremDIR_B
                                   ,cumloss    = CumPaidLoss_B
                                   ,loss_ratio = CumPaidLoss_B / EarnedPremDIR_B)]

knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
lsos()
prodliab_dt
prodliab_dt[, unique(GRCODE)]
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
prodliab_dt
prodliab_ss_dt
prodliab_ss_dt[premium > 0, unique(GRCODE)]
prodliab_ss_dt[premium > 0, unique(grcode)]
prodliab_ss_dt[grcode == 683]
prodliab_ss_dt[grcode == 841]
prodliab_dt[, unique(GRCODE)]
prodliab_ss_dt[grcode == 1406]
prodliab_dt[, unique(GRCODE)]
prodliab_ss_dt[grcode == 7854]
prodliab_dt[grcode == 7854]
prodliab_dt[GRCODE == 7854]
prodliab_dt[, unique(GRCODE)]
prodliab_dt[GRCODE == 10019]
prodliab_dt[, unique(GRCODE)]
prodliab_dt[GRCODE == 10115]
prodliab_dt[, unique(GRCODE)]
prodliab_dt[GRCODE == 10232]
prodliab_dt[, all(EarnedPremDIR_F2 > 0), by = GRCODE]
prodliab_dt[GRCODE == 32514]
prodliab_dt[, all(EarnedPremDIR_F2 > 0), by = GRCODE]
prodliab_dt[, .(allpositive = all(EarnedPremDIR_F2 > 0)), by = GRCODE]
prodliab_dt[, .(allpositive = all(EarnedPremDIR_F2 > 0)), by = GRCODE][allpositive]
prodliab_dt[, .(allpositive = all(EarnedPremDIR_F2 > 0)), by = GRCODE][allpositive == tRUE]
prodliab_dt[, .(allpositive = all(EarnedPremDIR_F2 > 0)), by = GRCODE][allpositive == TRUE]
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
lsos()
getwd()
rm(list = ls())
getwd()
knit2pdf("talkbm201604.Rnw")
getwd()
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
as.triangle(dcast(ppauto_ss_dt[grcode == 43]
           ,grcode + accyear + premium ~ devlag
           ,value.var = 'cumloss'))
ppauto_ss_dt
as.triangle(dcast(ppauto_ss_dt[grcode == 43],grcode + accyear + premium ~ devlag,value.var = 'cumloss'))
dcast(ppauto_ss_dt[grcode == 43],grcode + accyear + premium ~ devlag,value.var = 'cumloss')
dcast(ppauto_ss_dt[grcode == 43],accyear + premium ~ devlag,value.var = 'cumloss')
dcast(ppauto_ss_dt[grcode == 43],accyear ~ devlag,value.var = 'cumloss')
as.triangle(dcast(ppauto_ss_dt[grcode == 43],accyear ~ devlag,value.var = 'cumloss'))
?as.triangle
as.triangle(as.matrix(dcast(ppauto_ss_dt[grcode == 43],accyear ~ devlag,value.var = 'cumloss')))
as.triangle(as.matrix(dcast(ppauto_ss_dt[grcode == 43],accyear ~ devlag,value.var = 'cumloss')), origin = 'accyear')
as.triangle(as.matrix(dcast(ppauto_ss_dt[grcode == 43],accyear ~ devlag,value.var = 'cumloss')))
as.triangle(ppauto_ss_dt[grcode == 43][, .(accyear, devlag, cumloss)])
ppauto_ss_dt[grcode == 43][, .(accyear, devlag, cumloss)]
as.matrix(ppauto_ss_dt[grcode == 43][, .(accyear, devlag, cumloss)])
as.triangle(as.matrix(ppauto_ss_dt[grcode == 43][, .(accyear, devlag, cumloss)]))
as.triangle(as.matrix(dcast(ppauto_ss_dt[grcode == 43],accyear ~ devlag,value.var = 'cumloss')))
?as.triangle
as.triangle(as.matrix(dcast(ppauto_ss_dt[grcode == 43],accyear ~ devlag,value.var = 'cumloss')))
plot(as.triangle(as.matrix(dcast(ppauto_ss_dt[grcode == 43],accyear ~ devlag,value.var = 'cumloss'))))
plot(as.triangle(as.matrix(dcast(ppauto_ss_dt[grcode == 43],accyear ~ devlag,value.var = 'cumloss'))), lattice = TRUE)
as.triangle(as.matrix(dcast(ppauto_ss_dt[grcode == 43],accyear ~ devlag,value.var = 'cumloss')))
ppauto_ss_triangle <- as.triangle(as.matrix(dcast(ppauto_ss_dt[grcode == 43],accyear ~ devlag,value.var = 'cumloss')))
MackChainLadder(ppauto_ss_triangle)
ppauto_ss_triangle
str(ppauto_ss_triangle)
ppauto_ss_triangle$dev
attr(ppauto_ss_triangle, 'dev')
ppauto_ss_triangle
as.matrix(dcast(ppauto_ss_dt[grcode == 43],accyear ~ devlag,value.var = 'cumloss'))
as.matrix(dcast(ppauto_ss_dt[grcode == 43],accyear ~ devlag,value.var = 'cumloss')[,-1,with = FALSE])
as.triangle(as.matrix(dcast(ppauto_ss_dt[grcode == 43],accyear ~ devlag,value.var = 'cumloss')[,-1,with = FALSE]))
str(as.triangle(as.matrix(dcast(ppauto_ss_dt[grcode == 43],accyear ~ devlag,value.var = 'cumloss')[,-1,with = FALSE])))
ppauto_ss_triangle <- as.triangle(as.matrix(dcast(ppauto_ss_dt[grcode == 43],accyear ~ devlag,value.var = 'cumloss')[,-1,with = FALSE])))
ppauto_ss_triangle <- as.triangle(as.matrix(dcast(ppauto_ss_dt[grcode == 43],accyear ~ devlag,value.var = 'cumloss')[,-1,with = FALSE]))
MackChainLadder(ppauto_ss_triangle)
MackChainLadder(ppauto_ss_triangle)$FullTriangle
ppauto_ss_mack <- MackChainLadder(ppauto_ss_triangle)
plot(ppauto_ss_mack)
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
knit2pdf("talkbm201604.Rnw")
ppauto_mat <- as.matrix(dcast(ppauto_ss_dt[grcode == 43]
                             ,accyear ~ devlag
                             ,value.var = 'cumloss')[,-1,with=FALSE])

ppauto_triangle <- as.triangle(ppauto_mat)

lsos()
ppauto_mack <- MackChainLadder(ppauto_triangle, est.sigma = "Mack")

ppauto_mack
ppauto_mack$f
summary(ppauto_mack)
q()
y
